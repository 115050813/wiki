<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.4">
<title>programming</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Remove comment around @import statement below when using as a custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
[hidden],template{display:none}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
body{margin:0}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}
input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*:before,*:after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
body{-webkit-font-smoothing:antialiased}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.spread{width:100%}
p.lead,.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{font-size:1.21875em;line-height:1.6}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol,ul.no-bullet,ol.no-bullet{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.no-bullet{list-style:none}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite:before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media only screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7;font-weight:bold}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
body{tab-size:4}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix:before,.clearfix:after,.float-group:before,.float-group:after{content:" ";display:table}
.clearfix:after,.float-group:after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menu{color:rgba(0,0,0,.8)}
b.button:before,b.button:after{position:relative;top:-1px;font-weight:400}
b.button:before{content:"[";padding:0 3px 0 2px}
b.button:after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header:before,#header:after,#content:before,#content:after,#footnotes:before,#footnotes:after,#footer:before,#footer:after{content:" ";display:table}
#header:after,#content:after,#footnotes:after,#footer:after{clear:both}
#content{margin-top:1.25em}
#content:before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span:before{content:"\00a0\2013\00a0"}
#header .details br+span.author:before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark:before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber:after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media only screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}
@media only screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
.sect1{padding-bottom:.625em}
@media only screen and (min-width:768px){.sect1{padding-bottom:1.25em}}
.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor:before,h2>a.anchor:before,h3>a.anchor:before,#toctitle>a.anchor:before,.sidebarblock>.content>.title>a.anchor:before,h4>a.anchor:before,h5>a.anchor:before,h6>a.anchor:before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock>caption.title{white-space:nowrap;overflow:visible;max-width:0}
.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>.paragraph:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media only screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media only screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]:before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]:before{display:block}
.listingblock.terminal pre .command:before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt]):before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote:before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote:before{display:none}
.verseblock{margin:0 1em 1.25em 1em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 0 1.25em 0;display:block}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{text-align:left;word-spacing:0}
.quoteblock.abstract blockquote:before,.quoteblock.abstract blockquote p:first-of-type:before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
table.tableblock td>.paragraph:last-child p>p:last-child,table.tableblock th>p:last-child,table.tableblock td>p:last-child{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all th.tableblock,table.grid-all td.tableblock{border-width:0 1px 1px 0}
table.grid-all tfoot>tr>th.tableblock,table.grid-all tfoot>tr>td.tableblock{border-width:1px 1px 0 0}
table.grid-cols th.tableblock,table.grid-cols td.tableblock{border-width:0 1px 0 0}
table.grid-all *>tr>.tableblock:last-child,table.grid-cols *>tr>.tableblock:last-child{border-right-width:0}
table.grid-rows th.tableblock,table.grid-rows td.tableblock{border-width:0 0 1px 0}
table.grid-all tbody>tr:last-child>th.tableblock,table.grid-all tbody>tr:last-child>td.tableblock,table.grid-all thead:last-child>tr>th.tableblock,table.grid-rows tbody>tr:last-child>th.tableblock,table.grid-rows tbody>tr:last-child>td.tableblock,table.grid-rows thead:last-child>tr>th.tableblock{border-bottom-width:0}
table.grid-rows tfoot>tr>th.tableblock,table.grid-rows tfoot>tr>td.tableblock{border-width:1px 0 0 0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot{border-width:1px 0}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.unstyled,ol.unnumbered,ul.checklist,ul.none{list-style-type:none}
ul.unstyled,ol.unnumbered,ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1em;font-size:.85em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{width:1em;position:relative;top:1px}
ul.inline{margin:0 auto .625em auto;margin-left:-1.375em;margin-right:0;padding:0;list-style:none;overflow:hidden}
ul.inline>li{list-style:none;float:left;margin-left:1.375em;display:block}
ul.inline>li>*{display:block}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist>table tr>td:first-of-type{padding:0 .75em;line-height:1}
.colist>table tr>td:last-of-type{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em 0;border-width:1px 0 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;text-indent:-1.05em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note:before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip:before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning:before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution:before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important:before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]:after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@media print{@page{margin:1.25cm .75cm}
*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare):after,a[href^="https:"]:not(.bare):after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]:after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
.sect1{padding-bottom:0!important}
.sect1+.sect1{border:0!important}
#header>h1:first-child{margin-top:1.25rem}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em 0}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span:before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]:before{display:block}
#footer{background:none!important;padding:0 .9375em}
#footer-text{color:rgba(0,0,0,.6)!important;font-size:.9em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.5.0/css/font-awesome.min.css">
<style>
/* Stylesheet for CodeRay to match GitHub theme | MIT License | http://foundation.zurb.com */
/*pre.CodeRay {background-color:#f7f7f8;}*/
.CodeRay .line-numbers{border-right:1px solid #d8d8d8;padding:0 0.5em 0 .25em}
.CodeRay span.line-numbers{display:inline-block;margin-right:.5em;color:rgba(0,0,0,.3)}
.CodeRay .line-numbers strong{color:rgba(0,0,0,.4)}
table.CodeRay{border-collapse:separate;border-spacing:0;margin-bottom:0;border:0;background:none}
table.CodeRay td{vertical-align: top;line-height:1.45}
table.CodeRay td.line-numbers{text-align:right}
table.CodeRay td.line-numbers>pre{padding:0;color:rgba(0,0,0,.3)}
table.CodeRay td.code{padding:0 0 0 .5em}
table.CodeRay td.code>pre{padding:0}
.CodeRay .debug{color:#fff !important;background:#000080 !important}
.CodeRay .annotation{color:#007}
.CodeRay .attribute-name{color:#000080}
.CodeRay .attribute-value{color:#700}
.CodeRay .binary{color:#509}
.CodeRay .comment{color:#998;font-style:italic}
.CodeRay .char{color:#04d}
.CodeRay .char .content{color:#04d}
.CodeRay .char .delimiter{color:#039}
.CodeRay .class{color:#458;font-weight:bold}
.CodeRay .complex{color:#a08}
.CodeRay .constant,.CodeRay .predefined-constant{color:#008080}
.CodeRay .color{color:#099}
.CodeRay .class-variable{color:#369}
.CodeRay .decorator{color:#b0b}
.CodeRay .definition{color:#099}
.CodeRay .delimiter{color:#000}
.CodeRay .doc{color:#970}
.CodeRay .doctype{color:#34b}
.CodeRay .doc-string{color:#d42}
.CodeRay .escape{color:#666}
.CodeRay .entity{color:#800}
.CodeRay .error{color:#808}
.CodeRay .exception{color:inherit}
.CodeRay .filename{color:#099}
.CodeRay .function{color:#900;font-weight:bold}
.CodeRay .global-variable{color:#008080}
.CodeRay .hex{color:#058}
.CodeRay .integer,.CodeRay .float{color:#099}
.CodeRay .include{color:#555}
.CodeRay .inline{color:#000}
.CodeRay .inline .inline{background:#ccc}
.CodeRay .inline .inline .inline{background:#bbb}
.CodeRay .inline .inline-delimiter{color:#d14}
.CodeRay .inline-delimiter{color:#d14}
.CodeRay .important{color:#555;font-weight:bold}
.CodeRay .interpreted{color:#b2b}
.CodeRay .instance-variable{color:#008080}
.CodeRay .label{color:#970}
.CodeRay .local-variable{color:#963}
.CodeRay .octal{color:#40e}
.CodeRay .predefined{color:#369}
.CodeRay .preprocessor{color:#579}
.CodeRay .pseudo-class{color:#555}
.CodeRay .directive{font-weight:bold}
.CodeRay .type{font-weight:bold}
.CodeRay .predefined-type{color:inherit}
.CodeRay .reserved,.CodeRay .keyword {color:#000;font-weight:bold}
.CodeRay .key{color:#808}
.CodeRay .key .delimiter{color:#606}
.CodeRay .key .char{color:#80f}
.CodeRay .value{color:#088}
.CodeRay .regexp .delimiter{color:#808}
.CodeRay .regexp .content{color:#808}
.CodeRay .regexp .modifier{color:#808}
.CodeRay .regexp .char{color:#d14}
.CodeRay .regexp .function{color:#404;font-weight:bold}
.CodeRay .string{color:#d20}
.CodeRay .string .string .string{background:#ffd0d0}
.CodeRay .string .content{color:#d14}
.CodeRay .string .char{color:#d14}
.CodeRay .string .delimiter{color:#d14}
.CodeRay .shell{color:#d14}
.CodeRay .shell .delimiter{color:#d14}
.CodeRay .symbol{color:#990073}
.CodeRay .symbol .content{color:#a60}
.CodeRay .symbol .delimiter{color:#630}
.CodeRay .tag{color:#008080}
.CodeRay .tag-special{color:#d70}
.CodeRay .variable{color:#036}
.CodeRay .insert{background:#afa}
.CodeRay .delete{background:#faa}
.CodeRay .change{color:#aaf;background:#007}
.CodeRay .head{color:#f8f;background:#505}
.CodeRay .insert .insert{color:#080}
.CodeRay .delete .delete{color:#800}
.CodeRay .change .change{color:#66f}
.CodeRay .head .head{color:#f4f}
</style>
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>programming</h1>
<div class="details">
<span id="author" class="author"></span><br>
<span id="revnumber">version ,</span>
<span id="revdate">2016/03/17 20:48</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#cardgame-programming">CardGame - Programming</a>
<ul class="sectlevel2">
<li><a href="#introduction">Introduction</a></li>
<li><a href="#short-list">Short list</a></li>
<li><a href="#gamestage-and-gameplay">GameStage and GamePlay</a></li>
<li><a href="#entities">Entities</a></li>
<li><a href="#world">World</a></li>
<li><a href="#select">Select</a></li>
<li><a href="#states">States</a></li>
<li><a href="#managers">Managers</a></li>
<li><a href="#controls">Controls</a></li>
<li><a href="#cardlibrary">CardLibrary</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="cardgame-programming">CardGame - Programming</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="introduction">Introduction</h3>
<div class="paragraph">
<p>This is the section descibled the detail process of Programming the card game in Java, Groovy</p>
</div>
<div class="paragraph">
<p>Almost the tasks are trivial and suite for beginers and newbies to JME3.</p>
</div>
<div class="paragraph">
<p>FYI, some part require knowledge:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>advanced Java concept such as multi-threading, serialize … Groovy such as Closure</p>
</li>
<li>
<p>JME3 like …AppState, picking…</p>
</li>
<li>
<p>or knowledge of Atom framework</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>which you should read before start here. The links help you can revise your knowledges:</p>
</div>
<div class="paragraph">
<p><a href="../../../jme3.html">JME3 Advanced</a>
<a href="../../../jme3/scripting.html">JME3 Scripting</a>
<a href="../../../jme3/advanced/atom_framework.html">AtomFramework</a></p>
</div>
</div>
<div class="sect2">
<h3 id="short-list">Short list</h3>
<div class="paragraph">
<p>Checklist of what we going to implementation in this tutorial:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>GameStage and Gameplay</p>
<div class="ulist">
<ul>
<li>
<p>Card gameplay elements (Game, Turn, Phase,..)</p>
</li>
<li>
<p>GameWorld</p>
</li>
<li>
<p>Select/Picking</p>
</li>
<li>
<p>Start/pause</p>
</li>
<li>
<p>Save/load game states</p>
</li>
</ul>
</div>
</li>
<li>
<p>Entities</p>
<div class="ulist">
<ul>
<li>
<p>Card</p>
</li>
<li>
<p>More</p>
</li>
</ul>
</div>
</li>
<li>
<p>States</p>
<div class="ulist">
<ul>
<li>
<p>Menu</p>
</li>
<li>
<p>InGame</p>
</li>
<li>
<p>Loading</p>
</li>
</ul>
</div>
</li>
<li>
<p>Managers</p>
<div class="ulist">
<ul>
<li>
<p>StageManager</p>
</li>
<li>
<p>GUIManager</p>
</li>
<li>
<p>GamePlayManager</p>
</li>
</ul>
</div>
</li>
<li>
<p>Controls</p>
<div class="ulist">
<ul>
<li>
<p>SelectControl</p>
</li>
<li>
<p>CardEntityControl</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="gamestage-and-gameplay">GameStage and GamePlay</h3>
<div class="paragraph">
<p>Here is where you clean up your game design, and write down a few most obvious Classes that build up the game.</p>
</div>
<div class="paragraph">
<p><strong>CardGame</strong> : obvious</p>
</div>
<div class="paragraph">
<p><strong>Card</strong> : represent a Card in the game</p>
</div>
<div class="paragraph">
<p><strong>CardPlayer</strong> extends <strong>Player</strong>: a Player in Atom framework have basic ID, name, character…, already have built-in mechanism to go online -multiplayers if need!</p>
</div>
<div class="paragraph">
<p><strong>CardTable</strong> extends <strong>GameLevel</strong>: represent the Table where two opponent sit and duel. Of course we can have different levels (in different Modes) like when Player traveling around and play in the future!</p>
</div>
<div class="paragraph">
<p><strong>CardMatch</strong> : a Match can be held between two CardPlayer opponents</p>
</div>
<div class="paragraph">
<p><strong>Turn</strong> : a Turn represent a Turn in this card game. Has index number and a point to a Player take that Turn. a Turn has 6 TurnPhase (s)</p>
</div>
<div class="paragraph">
<p><strong>TurnPhase</strong> : DrawPhase, MainPhase, MainPhase2… contains a bunch of CardAction</p>
</div>
<div class="paragraph">
<p><strong>CardAction</strong> : obvious. action taken of Player, like : add one more card in his hand and summon etc…</p>
</div>
<div class="paragraph">
<p>see the full implementation in the source code. Detailed explanation below!</p>
</div>
</div>
<div class="sect2">
<h3 id="entities">Entities</h3>
<div class="sect3">
<h4 id="card">Card</h4>
<div class="paragraph">
<p>Consider the a Card as a most basic Entity.
[ Warning: Don&#8217;t mistake I&#8217;m going to use any kind of Composing Entity System here! ].</p>
</div>
<div class="paragraph">
<p>An Card Entity should contains infomations relate to a real card in a card game, it also has a representation, which is a 3D Model in JME scenegraph. That’s why Card class extends SpatialEntity.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>  SpatialEntity This is the handy parent class for classes in Atom framework which also holding Entity data, and has a Spatial as representation. Atom use a built-in two-way connection between the Entity – Spatial, a mechanism which helps you do almost anything you want with SpatialEntity (select-picking,enable/disable…ect)</pre>
</div>
</div>
<div class="paragraph">
<p>Information relate to the orginal Magic card game:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">String</span> cardId=<span class="error">”</span><span class="string"><span class="delimiter">&quot;</span><span class="content">
String name = “”
String picture = “”

int attack = -1
int defend = -1
String cardType = “”

String attribute = “”
</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>[…full in the source code.The meanings are obvious.]</p>
</div>
<div class="paragraph">
<p>If you declare like this in Groovy, that mean each of these fields are a Property, which have basic generated Setter/Getter by Groovy compiler. We need one more attribute:
Card orgCard</p>
</div>
<div class="paragraph">
<p>This hold a link to the orginal Card in the CardLibrary, which keeps information of every card avaiable in this game. We will implement this class later. Card.groovy</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">magiccard.gameplay</span>

<span class="namespace">import</span> <span class="namespace">com.jme3.scene.Spatial</span>
<span class="namespace">import</span> <span class="namespace">sg.atom.entity.SpatialEntity</span>
<span class="comment">/**
*
* @author cuong.nguyenmanh2
*/</span>
<span class="namespace">public</span> <span class="namespace">class</span> <span class="namespace">Card</span>  <span class="namespace">extends</span> <span class="namespace">SpatialEntity</span>{
    <span class="namespace">String</span> <span class="namespace">cardId</span>=<span class="error">”</span><span class="string"><span class="delimiter">&quot;</span><span class="content">
    String name = “”
    String picture = “”

    int attack = -1
    int defend = -1
    String cardType = “”

    String attribute = “”
    String cardSubType = “”
    int level = -1

    String summonRule = “”
    String effect = “”
    String desc = “”
    String longDesc = “”
    String character = “”
    String flipScript=”</span><span class="delimiter">&quot;</span></span>
    <span class="namespace">String</span> <span class="namespace">effectScript</span>=<span class="error">”</span><span class="string"><span class="delimiter">&quot;</span><span class="content">
    String rarity=”</span><span class="delimiter">&quot;</span></span>
    <span class="namespace">Card</span> <span class="namespace">orgCard</span>

    <span class="namespace">public</span> <span class="namespace">Card</span>(<span class="namespace">String</span> <span class="namespace">name</span>){
        <span class="namespace">super</span>(<span class="namespace">name</span>,<span class="namespace">name</span>)
        <span class="namespace">this.name</span> = <span class="namespace">name</span>
    }

    <span class="namespace">public</span> <span class="namespace">Card</span>(<span class="namespace">Card</span> <span class="namespace">orgCard</span>){
        <span class="namespace">super</span>(<span class="namespace">orgCard.name</span>,<span class="namespace">orgCard.name</span>)
        <span class="namespace">this.orgCard</span> = <span class="namespace">orgCard</span>
        <span class="namespace">this.cardId</span> = <span class="namespace">orgCard.cardId</span>
        <span class="namespace">this.name</span> = <span class="namespace">orgCard.name</span>
        <span class="namespace">this.picture</span> = <span class="namespace">orgCard.picture</span>
        <span class="namespace">this.attack</span> = <span class="namespace">orgCard.attack</span>
        <span class="namespace">this.defend</span> = <span class="namespace">orgCard.defend</span>
        <span class="namespace">this.cardType</span> = <span class="namespace">orgCard.cardType</span>
        <span class="namespace">this.level</span> = <span class="namespace">orgCard.level</span>
        <span class="namespace">this.desc</span> = <span class="namespace">orgCard.desc</span>
        <span class="namespace">this.longDesc</span> = <span class="namespace">orgCard.longDesc</span>
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="show-the-card">Show the card</h4>
<div class="paragraph">
<p>According to the Atom framework, the representation part of a Card should be provided by a EntityFactory. In this implementation, I just ask the GameLevel – The CardTable, to made it up, cause it’s really simple.</p>
</div>
<div class="paragraph">
<p>Now consider a Card spatial built from a flatten 3d box and 2 sides: front &amp; back with approriate textures title FrontTexture and BackTexture. In YugiGame, BackTexture are the same for all the Card, remember that we already set it in the SceneEditor! Now our job is to load the Card model and change the FrontTexture to the path in card.picture.</p>
</div>
<div class="paragraph">
<p>This is a part of the CardTable class which create and “attach” the Card spatial to the levelNode, add two more controls for movement handle and select handle. Simple isn’t it?</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">    <span class="directive">public</span> <span class="type">void</span> createCardOrg(){
        cardOrg = ((Node) ((Node) assetManager.loadModel(<span class="error">“</span>Models/Cards/Template/card1.j3o<span class="error">”</span>)).getChild(<span class="error">“</span>Card<span class="error">”</span>)).getChild(<span class="error">“</span>Cube1<span class="error">″</span>);
    }
    Geometry createCard(Card card) {
        <span class="comment">// extract the card info</span>
        <span class="predefined-type">String</span> path = card.picture

        <span class="comment">// create the geometry</span>
        Geometry newCard = (Geometry) cardOrg.clone();
        Material cloneMat = newCard.getMaterial().clone();
        cloneMat.setTexture(<span class="error">“</span>ColorMap2<span class="error">″</span>, assetManager.loadTexture(path));
        newCard.setMaterial(cloneMat);
        <span class="comment">//cloneMat.setBoolean(“MixGlow”,true);</span>
        levelNode.attachChild(newCard);
        card.spatial = newCard;
        newCard.setLocalScale(-<span class="float">0.4f</span>,-<span class="float">0.4f</span>,<span class="float">0.4f</span>)
        <span class="comment">// attach the control</span>
        newCard.addControl(<span class="keyword">new</span> CardSpatialControl(worldManager,card));
        newCard.addControl(<span class="keyword">new</span> CardSelectControl(worldManager,gamePlayManager));
        <span class="keyword">return</span> newCard;
    }</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="card-movement">Card movement</h4>
<div class="literalblock">
<div class="content">
<pre>  For this kind of game, I just want to introduce most basic movement form, Steering movements with brace, veclocity..etc will be introduced in next tuts.</pre>
</div>
</div>
<div class="paragraph">
<p>By basic movement forms, I want to talk about:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>– MOVETO: Move smoothly in a straight line from one point to another.
– ROTTO: Rotate smoothly by Quaternion from one angle to another.
– GIGGLE : Shaking, for example prepare to explode!</pre>
</div>
</div>
<div class="paragraph">
<p>These 3 basic movement types are already enough to compose quite fascinated effects if you know how to. See by your self in the video in the first post! The most normal and obvious way to put movements into a Spatial in JME3 is to make an Control, name it CardSpatialControl.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">magiccard.gameplay</span>

<span class="namespace">import</span> <span class="namespace">com.jme3.scene.control.AbstractControl</span>
<span class="namespace">import</span> <span class="namespace">com.jme3.math.Vector3f</span>
<span class="namespace">import</span> <span class="namespace">com.jme3.math.FastMath</span>;
<span class="keyword">import</span> <span class="include">sg.atom.entity.SpatialEntityControl</span>
<span class="include">import</span> <span class="include">sg.atom.stage.SelectManager</span>
<span class="include">import</span> <span class="include">sg.atom.stage.WorldManager</span>
<span class="include">import</span> <span class="include">com.jme3.math.Quaternion</span>
<span class="comment">/**
 *
 * @author hungcuong
 */</span>
<span class="include">public</span> <span class="include">class</span> <span class="include">CardSpatialControl</span> <span class="include">extends</span> <span class="include">SpatialEntityControl</span>{

    <span class="include">boolean</span> <span class="include">stopMove</span> = <span class="include">false</span>;
    <span class="type">boolean</span> stopRot = <span class="predefined-constant">false</span>;
    <span class="type">boolean</span> gigle = <span class="predefined-constant">false</span>;
    Vector3f targetPos;
    Vector3f oldPos;
    Quaternion oldRot;
    Quaternion targetRot;
    <span class="type">float</span> timeRot = <span class="integer">0</span>;
    <span class="type">float</span> speedRot = <span class="float">0.3f</span>;
    <span class="type">float</span> speedPos = <span class="float">0.04f</span>;

    <span class="directive">public</span> CardSpatialControl(WorldManager worldManager, Card card) {
        <span class="local-variable">super</span>(worldManager, card);
    }

    <span class="type">void</span> pos(Vector3f targetPos){
        <span class="local-variable">this</span>.targetPos = targetPos.clone();;
        <span class="local-variable">this</span>.oldPos = spatial.getLocalTranslation().clone();
        stopMove = <span class="predefined-constant">false</span>;
    }
    <span class="type">void</span> rot(Quaternion targetRot){
        <span class="local-variable">this</span>.targetRot = targetRot.clone();
        <span class="local-variable">this</span>.oldRot = spatial.getLocalRotation().clone();
        timeRot = <span class="integer">0</span>;
        stopRot = <span class="predefined-constant">false</span>;
    }

    <span class="directive">public</span> <span class="type">void</span> controlUpdate(<span class="type">float</span> tpf){
        updatePos(tpf);
        updateRot(tpf);
        <span class="keyword">if</span> (gigle){
            updateGiggle();
        }
    }
    <span class="type">void</span> updatePos(<span class="type">float</span> tpf){
        <span class="keyword">if</span> (targetPos!=<span class="predefined-constant">null</span>){
            Vector3f newPos;
            Vector3f currentPos = spatial.getLocalTranslation();
            <span class="type">float</span> dis = currentPos.distance(targetPos)
            <span class="keyword">if</span> (!stopMove){
                <span class="keyword">if</span> ( dis&gt; speedPos){
                    Vector3f force = targetPos.subtract(currentPos).normalize().mult(speedPos)
                    newPos = currentPos.add(force)
                } <span class="keyword">else</span> {
                    newPos = targetPos.clone();
                    stopMove = <span class="predefined-constant">true</span>;

                }
                spatial.setLocalTranslation(newPos)
            }

        }
    }

    <span class="type">void</span> updateRot(<span class="type">float</span> tpf){
        <span class="keyword">if</span> (targetRot!=<span class="predefined-constant">null</span>&amp;&amp;oldRot!=<span class="predefined-constant">null</span>){
            <span class="keyword">if</span> (!stopRot){
                Quaternion newRot = <span class="keyword">new</span> Quaternion();
                <span class="keyword">if</span> ( timeRot &lt;speedRot){
                    newRot.slerp(oldRot,targetRot,(<span class="type">float</span>)(timeRot/speedRot))
                    timeRot += tpf;
                } <span class="keyword">else</span> {
                    stopRot = <span class="predefined-constant">true</span>;
                    newRot.set(targetRot)
                }
                spatial.setLocalRotation(newRot);
            }
        }
    }

    <span class="type">void</span> updateGiggle(){
        <span class="type">float</span> x =(<span class="float">0.5f</span>-FastMath.nextRandomFloat()) * <span class="float">0.005f</span>;
        <span class="type">float</span> y =(<span class="float">0.5f</span>-FastMath.nextRandomFloat()) * <span class="float">0.005f</span>;
        <span class="type">float</span> z =<span class="integer">0</span>;
        Vector3f oldPos=spatial.getLocalTranslation().clone();
        spatial.setLocalTranslation(oldPos.add(x,y,z));
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="more">More</h4>

</div>
</div>
<div class="sect2">
<h3 id="world">World</h3>
<div class="paragraph">
<p>First consider the Table a GameLevel. In that specific enviroment, cards are showed, moved rotated…etc..</p>
</div>
<div class="paragraph">
<p><strong>Explanation:</strong>
The CardTable take care of 3 things:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>  (1| Creating:</pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Its self from a 16×16 Quad and the Texture</p>
<div class="olist upperalpha">
<ol class="upperalpha" type="A">
<li>
<p>The Cards from the OrgCard model with appropriate picture</p>
</li>
<li>
<p>The effects</p>
</li>
<li>
<p>The 3D models</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="literalblock">
<div class="content">
<pre>  (2| Destroying things in delayed fashion:</pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Explode the Card (cool effect!)</p>
</li>
</ol>
</div>
<div class="literalblock">
<div class="content">
<pre>  (3| Calculate the postions,directions of all action triggered by GamePlay. Arrange and reArrange the cards in hands, in Deck. handPos,gravePos,groundPos, deckPos…etc</pre>
</div>
</div>
<div class="paragraph">
<p>We need the world to calculate postions the card place and for the translating: the target position of which the card will head to. Remember that we made a Table texture from a 4×4 Grid. Now use that and do simple math ;O :</p>
</div>
<div class="paragraph">
<p>This part</p>
</div>
<div class="ulist">
<ul>
<li>
<p>load the level</p>
</li>
<li>
<p>create a deck</p>
</li>
<li>
<p>load card models with texture (cover) and attach a CardControl to handle the Movement and highlight</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">magiccard.gameplay</span>

<span class="namespace">import</span> <span class="namespace">com.jme3.asset.AssetManager</span>
<span class="namespace">import</span> <span class="namespace">com.jme3.material.Material</span>
<span class="namespace">import</span> <span class="namespace">com.jme3.math.ColorRGBA</span>
<span class="namespace">import</span> <span class="namespace">com.jme3.math.Vector3f</span>
<span class="namespace">import</span> <span class="namespace">com.jme3.scene.Node</span>
<span class="namespace">import</span> <span class="namespace">com.jme3.scene.Geometry</span>
<span class="namespace">import</span> <span class="namespace">com.jme3.scene.Spatial</span>
<span class="namespace">import</span> <span class="namespace">com.jme3.scene.shape.Box</span>
<span class="namespace">import</span> <span class="namespace">com.jme3.scene.shape.Quad</span>
<span class="namespace">import</span> <span class="namespace">sg.atom.gameplay.GameLevel</span>
<span class="namespace">import</span> <span class="namespace">sg.atom.stage.GamePlayManager</span>
<span class="namespace">import</span> <span class="namespace">sg.atom.stage.WorldManager</span>

<span class="namespace">import</span> <span class="namespace">com.jme3.material.RenderState</span>
<span class="namespace">import</span> <span class="namespace">com.jme3.renderer.queue.RenderQueue</span>
<span class="namespace">import</span> <span class="namespace">com.jme3.scene.shape.Sphere</span>
<span class="namespace">import</span> <span class="namespace">com.jme3.math.Quaternion</span>
<span class="namespace">import</span> <span class="namespace">com.jme3.math.FastMath</span>
<span class="namespace">import</span> <span class="namespace">magiccard.stage.CardSelectControl</span>
<span class="namespace">import</span> <span class="namespace">sg.atom.fx.particle.ParticleFactory</span>
<span class="namespace">import</span> <span class="namespace">sg.atom.fx.particle.ExplosionNodeControl</span>
<span class="namespace">import</span> <span class="namespace">com.jme3.light.PointLight</span>
<span class="namespace">import</span> <span class="namespace">com.jme3.effect.ParticleEmitter</span>

<span class="namespace">class</span> <span class="namespace">CardTable</span> <span class="namespace">extends</span> <span class="namespace">GameLevel</span>{

<span class="namespace">private</span> <span class="namespace">Spatial</span> <span class="namespace">cardOrg</span>;
AssetManager assetManager

<span class="comment">// Layout to position cards and table</span>
Vector3f center = <span class="keyword">new</span> Vector3f(<span class="integer">3</span>,<span class="integer">0</span>,-<span class="integer">5</span>);
<span class="type">float</span> handLength= <span class="float">2.5f</span>
<span class="type">float</span> spaceBetweenCard = <span class="float">0.5f</span>
<span class="type">float</span> peakPos= <span class="float">0.2f</span>
<span class="type">float</span> boardSizeX = <span class="integer">16</span>;
<span class="type">float</span> boardSizeY= <span class="integer">16</span>;

Vector3f scaledCardSize = <span class="keyword">new</span> Vector3f(<span class="float">1.9f</span>,<span class="float">2.7f</span>,<span class="float">0.02f</span>);
Vector3f gridGapSize = <span class="keyword">new</span> Vector3f(<span class="integer">1</span>,<span class="integer">1</span>,<span class="integer">1</span>);
<span class="directive">public</span> <span class="directive">static</span> faceUpQuat = <span class="keyword">new</span> Quaternion().fromAngles(<span class="float">0f</span>,FastMath.PI,<span class="float">0f</span>);
<span class="directive">public</span> <span class="directive">static</span> faceDownQuat = <span class="keyword">new</span> Quaternion().fromAngles(-FastMath.PI,-FastMath.PI,<span class="float">0f</span>);
<span class="predefined-type">List</span> actions =<span class="type">[]</span>

<span class="directive">public</span> CardTable(GamePlayManager gameplay,WorldManager world,<span class="predefined-type">String</span> name,<span class="predefined-type">String</span> path){
<span class="local-variable">super</span>(gameplay,world,name,path)
assetManager = world.assetManager
}

Quaternion getCardRot(<span class="type">boolean</span> faceUp){
<span class="keyword">if</span> (faceUp){
<span class="keyword">return</span> faceUpQuat.clone()
} <span class="keyword">else</span> {
<span class="keyword">return</span> faceDownQuat.clone()
}
}

<span class="comment">/*
* Load level, override the method in GameLevel class
*/</span>
<span class="directive">public</span> <span class="type">void</span> loadLevel(){
<span class="local-variable">super</span>.loadLevel()
createCardOrg();
createCardBoard();
createEffects();
}

<span class="comment">/*
* Short for new Vector3f
*/</span>
Vector3f vec3(<span class="type">float</span> x,<span class="type">float</span> y,<span class="type">float</span> z){
<span class="keyword">return</span> <span class="keyword">new</span> Vector3f(x,y,z);
}

<span class="comment">/*
* Create the Card board model
*/</span>
<span class="directive">public</span> <span class="type">void</span> createCardBoard() {
<span class="comment">//levelNode = new Node(“LevelNode”);</span>

Quad cardBoardShape = <span class="keyword">new</span> Quad(boardSizeX,boardSizeY);
Geometry cardBoard = <span class="keyword">new</span> Geometry(<span class="error">“</span>CardBoardGeo<span class="error">”</span>, cardBoardShape);

Material mat = <span class="keyword">new</span> Material(assetManager, <span class="error">“</span>MatDefs/ColoredTextured.j3md<span class="error">”</span>);
mat.setTexture(<span class="error">“</span>ColorMap<span class="error">”</span>, assetManager.loadTexture(<span class="error">“</span>Textures/CardBoard/DiffuseTex.png<span class="error">”</span>));
mat.setColor(<span class="error">“</span><span class="predefined-type">Color</span><span class="error">”</span>, <span class="keyword">new</span> ColorRGBA(<span class="integer">1</span>, <span class="integer">1</span>, <span class="integer">1</span>, <span class="float">0.9f</span>));
mat.getAdditionalRenderState().setBlendMode(RenderState.BlendMode.Alpha);
cardBoard.setMaterial(mat);
cardBoard.setLocalTranslation(center.add((<span class="type">float</span>)(-boardSizeX/<span class="integer">2</span>),(<span class="type">float</span>)(-boardSizeY/<span class="integer">2</span>),<span class="float">0f</span>));
cardBoard.setQueueBucket(RenderQueue.Bucket.Transparent);

levelNode.attachChild(cardBoard);
}
<span class="comment">/*
* For debuging positions
*/</span>
<span class="directive">public</span> <span class="type">void</span> createSphere(<span class="type">float</span> size,ColorRGBA color,Vector3f pos){
Sphere sh=<span class="keyword">new</span> Sphere(<span class="integer">8</span>,<span class="integer">8</span>,size)
Geometry sGeo = <span class="keyword">new</span> Geometry(<span class="error">“</span>S<span class="error">”</span>,sh)
Material mat = <span class="keyword">new</span> Material(assetManager, <span class="error">“</span>Common/MatDefs/Misc/Unshaded.j3md<span class="error">”</span>);
sGeo.material = mat
mat.setColor(<span class="error">“</span><span class="predefined-type">Color</span><span class="error">”</span>,color)
sGeo.localTranslation = pos
levelNode.attachChild(sGeo)
}
<span class="comment">/*
* Create the orginal Card model
*/</span>
<span class="directive">public</span> <span class="type">void</span> createCardOrg(){
cardOrg = ((Node) ((Node) assetManager.loadModel(<span class="error">“</span>Models/Cards/Template/card1.j3o<span class="error">”</span>)).getChild(<span class="error">“</span>Card<span class="error">”</span>)).getChild(<span class="error">“</span>Cube1<span class="error">″</span>);
}

<span class="directive">public</span> <span class="type">void</span> createDeck(CardPlayer player) {
<span class="comment">// create Cards for player</span>

player.currentDeck.cardList.eachWithIndex{card,i-&gt;
<span class="comment">//fromDeckToHand(player)</span>
def newCard = createCard(card)
}
arrangeDeck(player)
}

<span class="directive">public</span> <span class="type">void</span> createHand(CardPlayer player){
player.hand.eachWithIndex{card,i-&gt;
<span class="comment">//fromDeckToHand(player)</span>
def newCard = createCard(card)
}
arrangeHand(player)
}

Geometry createCard(Card card) {
<span class="comment">// extract the card info</span>
<span class="predefined-type">String</span> path = card.picture

<span class="comment">// create the geometry</span>
Geometry newCard = (Geometry) cardOrg.clone();
Material cloneMat = newCard.getMaterial().clone();
cloneMat.setTexture(<span class="error">“</span>ColorMap2<span class="error">″</span>, assetManager.loadTexture(path));
newCard.setMaterial(cloneMat);
<span class="comment">//cloneMat.setBoolean(“MixGlow”,true);</span>
levelNode.attachChild(newCard);
card.spatial = newCard;
newCard.setLocalScale(-<span class="float">0.4f</span>,-<span class="float">0.4f</span>,<span class="float">0.4f</span>)
<span class="comment">// attach the control</span>
newCard.addControl(<span class="keyword">new</span> CardSpatialControl(worldManager,card));
newCard.addControl(<span class="keyword">new</span> CardSelectControl(worldManager,gamePlayManager));
<span class="keyword">return</span> newCard;
}

CardSpatialControl getCardControl(Spatial spatial){
<span class="keyword">return</span> spatial.getControl(CardSpatialControl.class)
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>These pieces help to find the exact location of card in each situation:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>ArrangeDeck</p>
</li>
<li>
<p>ArrangHand</p>
</li>
<li>
<p>CenterHandPos</p>
</li>
<li>
<p>DeckPos</p>
</li>
<li>
<p>GravePos</p>
</li>
<li>
<p>GroundPos</p>
</li>
<li>
<p>MagicPos</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">void</span> arrangeDeck(CardPlayer player){
<span class="type">int</span> numOfCards = player.currentDeck.cardList.size()

Vector3f centerDeck = getCenterHandPos(player);
Vector3f gap = vec3(<span class="float">0.4f</span>,<span class="integer">0</span>,<span class="float">0.02f</span>);
Vector3f handSize = vec3(<span class="integer">0</span>,<span class="integer">0</span>,<span class="float">0.5f</span>);

gap = handSize.divide(vec3(<span class="integer">1</span>,<span class="integer">1</span>,(<span class="type">float</span>) numOfCards));
player.currentDeck.cardList.eachWithIndex{card,i-&gt;
<span class="comment">//fromDeckToHand(player)</span>
def newCard = card.spatial

<span class="comment">//Quaternion rotPIY =new Quaternion().fromAngleAxis(FastMath.PI,Vector3f.UNIT_Y);</span>
<span class="comment">//Quaternion rotPIZ =new Quaternion().fromAngleAxis(FastMath.PI,Vector3f.UNIT_Z);</span>
<span class="comment">//Quaternion rotXYZ =new Quaternion().fromAngles(0f,FastMath.PI,0f)</span>
<span class="comment">//newCard.setLocalRotation(rotXYZ)</span>

Vector3f cardPos = gap.mult(vec3((<span class="type">float</span>)i,<span class="float">1f</span>,(<span class="type">float</span>)i));
Vector3f deckPos;
<span class="keyword">if</span> (isCurrentPlayer(player)){
deckPos =vec3(<span class="float">9f</span>,-<span class="float">6.5</span>,-<span class="integer">5</span>)
} <span class="keyword">else</span> {
deckPos =vec3(-<span class="float">3f</span>,<span class="float">6.5</span>,-<span class="integer">5</span>)
}
newCard.setLocalTranslation(deckPos.add(cardPos))
}
}
<span class="directive">public</span> <span class="type">void</span> arrangeHand(CardPlayer player){
<span class="type">int</span> numOfCards = player.hand.size()

Vector3f centerHand = getCenterHandPos(player);
Vector3f gap = vec3(<span class="float">0.4f</span>,<span class="float">0f</span>,<span class="float">0.02f</span>);
<span class="type">float</span> squareSize= boardSizeX-<span class="float">6f</span>
Vector3f handSize = vec3(squareSize,<span class="float">0f</span>,<span class="float">0.02f</span>);

gap = handSize.divide(vec3((<span class="type">float</span>) numOfCards,<span class="integer">1</span>,<span class="integer">1</span>));
<span class="type">boolean</span> faceUp = isCurrentPlayer(player);
player.hand.eachWithIndex{card,i-&gt;
<span class="comment">//fromDeckToHand(player)</span>
def newCard = card.spatial

Quaternion rotPIY =<span class="keyword">new</span> Quaternion().fromAngleAxis(FastMath.PI,Vector3f.UNIT_Y);
Quaternion rotPIZ =<span class="keyword">new</span> Quaternion().fromAngleAxis(FastMath.PI,Vector3f.UNIT_Z);
Quaternion rotXYZ =getCardRot(faceUp || gamePlayManager.debugMode)
<span class="comment">//newCard.setLocalRotation(rotXYZ)</span>

Vector3f cardPos = gap.mult(vec3((<span class="type">float</span>)i,<span class="float">1f</span>,(<span class="type">float</span>)i));
Vector3f handPos = centerHand.add(<span class="float">0f</span>,<span class="float">0f</span>,<span class="float">0f</span>);
<span class="comment">//newCard.setLocalTranslation(handPos.add(cardPos));</span>
CardSpatialControl cc=getCardControl(card.spatial)
cc.pos(handPos.add(cardPos))

cc.rot(rotXYZ)

}

}

<span class="type">void</span> putToGrave(){

}
<span class="type">boolean</span> isCurrentPlayer(CardPlayer player){
<span class="keyword">return</span> gamePlayManager.isCurrentPlayer(player)
}

Vector3f getCenterHandPos(CardPlayer player){
Vector3f centerHandPos;
<span class="type">float</span> halfSizeY = (<span class="type">float</span>)((boardSizeY <span class="error">–</span> <span class="float">0.3f</span>)/<span class="float">2f</span>);
<span class="keyword">if</span> (isCurrentPlayer(player)){
centerHandPos = center.add(<span class="float">0f</span>,-halfSizeY,<span class="float">0.5f</span>)
} <span class="keyword">else</span> {
centerHandPos = center.add(<span class="float">0f</span>,halfSizeY,<span class="float">0.5f</span>)
}
<span class="keyword">return</span> centerHandPos;
}

Vector3f handPos(CardPlayer player,<span class="type">int</span> index,<span class="type">boolean</span> peak){
Vector3f centerHandPos = getCenterHandPos(player)

<span class="type">int</span> numHandCards =player.hand.size()
<span class="type">float</span> indexf=<span class="integer">0</span>

<span class="keyword">if</span> (index == -<span class="integer">1</span>){
numHandCards ++
indexf = numHandCards
} <span class="keyword">else</span> <span class="keyword">if</span> (index == -<span class="integer">2</span>){
indexf = numHandCards + <span class="integer">2</span>
} <span class="keyword">else</span> <span class="keyword">if</span> (index == -<span class="integer">3</span>){
indexf = numHandCards
numHandCards = <span class="integer">5</span>
}
horizontalPos = handLength * indexf + numHandCards

Vector3f nextCardPos = vec3(<span class="integer">0</span>,horizontalPos,<span class="integer">0</span>).add(centerHandPos)

<span class="keyword">if</span> (peak){
nextCardPos.add(vec3(<span class="integer">0</span>,peakPos,<span class="integer">0</span>))
}
<span class="keyword">return</span> nextCardPos;
}

Vector3f deckPos(CardPlayer player){
<span class="keyword">if</span> (isCurrentPlayer(player)){
<span class="keyword">return</span> vec3(<span class="integer">1</span>,<span class="integer">1</span>,<span class="integer">1</span>)
} <span class="keyword">else</span> {
<span class="keyword">return</span> vec3(<span class="integer">1</span>,<span class="integer">4</span>,<span class="integer">1</span>)
}
}
Vector3f gravePos(CardPlayer player){
<span class="keyword">if</span> (isCurrentPlayer(player)){
<span class="keyword">return</span> vec3(<span class="integer">1</span>,<span class="integer">1</span>,<span class="integer">1</span>)
} <span class="keyword">else</span> {
<span class="keyword">return</span> vec3(<span class="integer">1</span>,<span class="integer">4</span>,<span class="integer">1</span>)
}
}
Vector3f groundPos(CardPlayer player,<span class="type">int</span> index){
<span class="keyword">if</span> (isCurrentPlayer(player)){
<span class="keyword">return</span> vec3(-<span class="float">0.8f</span>,-<span class="float">1.7f</span>,-<span class="integer">5</span>).add(scaledCardSize.mult(vec3((<span class="type">float</span>)index,<span class="float">0f</span>,<span class="float">0f</span>)))
} <span class="keyword">else</span> {
<span class="keyword">return</span> vec3(-<span class="float">0.8f</span>,<span class="float">1.7f</span>,-<span class="integer">5</span>).add(scaledCardSize.mult(vec3((<span class="type">float</span>)index,<span class="float">0f</span>,<span class="float">0f</span>)))
}
}
Vector3f magicPos(CardPlayer player,<span class="type">int</span> index){
<span class="keyword">if</span> (isCurrentPlayer(player)){
<span class="keyword">return</span> vec3(-<span class="float">0.8f</span>,-<span class="float">4.5f</span>,-<span class="integer">5</span>).add(scaledCardSize.mult(vec3((<span class="type">float</span>)index,<span class="float">0f</span>,<span class="float">0f</span>)))
} <span class="keyword">else</span> {
<span class="keyword">return</span> vec3(-<span class="float">0.8f</span>,<span class="float">4.5f</span>,-<span class="integer">5</span>).add(scaledCardSize.mult(vec3((<span class="type">float</span>)index,<span class="float">0f</span>,<span class="float">0f</span>)))
}
}
<span class="type">void</span> fromDeckToHand(CardPlayer player,Card card){
Vector3f nextCardPos=handPos(player,-<span class="integer">3</span>,<span class="predefined-constant">false</span>)
CardSpatialControl cc=getCardControl(card.spatial)
cc.pos(nextCardPos)
<span class="comment">//cc.faceUp()</span>
<span class="comment">//cc.moveTo(nextCardPos,3)</span>
}
<span class="type">void</span> fromHandToMagic(CardPlayer player,Card card){
Vector3f nextCardPos=magicPos(player,player.magic.size())
CardSpatialControl cc=getCardControl(card.spatial)
cc.pos(nextCardPos)
cc.rot(getCardRot(<span class="predefined-constant">false</span>))

}

<span class="type">void</span> fromHandToGround(CardPlayer player,Card card){
Vector3f nextCardPos=groundPos(player,player.ground.size())
CardSpatialControl cc=getCardControl(card.spatial)
cc.pos(nextCardPos)

}
<span class="directive">public</span> Vector3f getCamPos(){
<span class="keyword">return</span> center.add(<span class="float">0f</span>,-<span class="float">8f</span>,<span class="float">20f</span>)
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is the update hook of the Level. We update it by clean up and execute delayed actions!!!</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">void</span> simpleUpdate(<span class="type">float</span> tpf){
<span class="comment">// see if anything queued</span>
<span class="keyword">for</span> (<span class="predefined-type">Iterator</span> it=actions.iterator(); it.hasNext(); ) {
def action = it.next();
<span class="keyword">if</span> ((action.time -= tpf) &lt;<span class="integer">0</span>) {
action.do()
it.remove();
} <span class="keyword">else</span> {
<span class="comment">// do nothing but wait</span>
}
}
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Make a cool explosion effect by calling the Atom&#8217;s ParticleFactory, play it when a card destroyed</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="type">void</span> destroy(CardPlayer player,Card card){
addExplosion(card.spatial.localTranslation)
CardSpatialControl cc=getCardControl(card.spatial)
cc.gigle = <span class="predefined-constant">true</span>;
actions&lt;&lt;[
time:<span class="float">1f</span>,
<span class="keyword">do</span>:{
card.spatial.removeFromParent()
}
]
}

Node explosionPrefab;
<span class="type">void</span> addExplosion(Vector3f pos){
def explosion = explosionPrefab.clone();
explosion.localTranslation =pos.clone();
<span class="comment">/*
levelNode.attachChild(flame);
levelNode.attachChild(rain);
levelNode.attachChild(spark);
*/</span>
levelNode.attachChild(explosion);
}

<span class="type">void</span> createEffects(){
ParticleFactory pf = <span class="keyword">new</span> ParticleFactory(assetManager);
<span class="comment">/*
ParticleEmitter flame = pf.createFlame();
flame.setLocalTranslation(new Vector3f(6f,4f,-5f));

ParticleEmitter rain = pf.createRain(“”);
rain.setLocalTranslation(new Vector3f(0,0,-5f));

ParticleEmitter spark = pf.createSpark();
spark.setLocalTranslation(new Vector3f(0,0,-5f));
*/</span>
explosionPrefab = pf.createExplosionNode();
explosionPrefab.getControl(ExplosionNodeControl.class).setMaxTime(<span class="float">2f</span>)
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Load the card character 3d model for a specific card</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">void</span> loadCharacters(){

Quaternion rot= <span class="keyword">new</span> Quaternion().fromAngleAxis(FastMath.HALF_PI,Vector3f.UNIT_X)
<span class="comment">/*
Spatial demon = assetManager.loadModel(“Models/Demons/BlueEyeWhiteDragon/BlueEyes.j3o”);
demon.scale(0.04f);
demon.setLocalRotation(rot);
levelNode.attachChild(demon);
*/</span>
Spatial witch = assetManager.loadModel(<span class="error">“</span>Models/Demons/Magicians/White/WhiteFemaleMagician.j3o<span class="error">”</span>);
witch.scale(<span class="float">0.5f</span>);
witch.setLocalTranslation(<span class="keyword">new</span> Vector3f(<span class="float">3f</span>,<span class="float">4f</span>,-<span class="float">5f</span>));
witch.setLocalRotation(rot);
levelNode.attachChild(witch);

Spatial samurai = assetManager.loadModel(<span class="error">“</span>Models/Demons/Warior/SamuraiWarior.j3o<span class="error">”</span>);
samurai.setLocalTranslation(<span class="keyword">new</span> Vector3f(<span class="float">6f</span>,<span class="float">4f</span>,-<span class="float">5f</span>));
samurai.scale(<span class="float">0.5f</span>);
samurai.setLocalRotation(rot);
levelNode.attachChild(samurai);

<span class="comment">/** A white, spot light source. */</span>
PointLight lamp = <span class="keyword">new</span> PointLight();
lamp.setPosition(getCamPos());
lamp.setColor(ColorRGBA.White);
levelNode.addLight(lamp);
}
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="select">Select</h3>
<div class="paragraph">
<p>For a card game, select is a very important game mechanic, in fact, you are nearly ask to select/choose somethings almost everytime. In Atom, I introduce a generic way to hook your select function into your code game mechanic.
This section is quite advance for who don’t familiar with groovy but keep your self cheerful cause you going to enjoy Groovy as much as I do!</p>
</div>
<div class="paragraph">
<p>Short:</p>
</div>
<div class="paragraph">
<p>Detailed:</p>
</div>
<div class="paragraph">
<p>For this card game, we will implement a few things in this designed mechanic:</p>
</div>
<div class="sect3">
<h4 id="select-function">Select function:</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="select-condition">Select condition:</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="select-control">Select Control:</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">magiccard.stage</span>;

<span class="keyword">import</span> <span class="include">com.jme3.math.Vector3f</span>;
<span class="keyword">import</span> <span class="include">com.jme3.scene.Geometry</span>;
<span class="keyword">import</span> <span class="include">com.jme3.scene.Spatial</span>;
<span class="keyword">import</span> <span class="include">sg.atom.stage.WorldManager</span>;
<span class="keyword">import</span> <span class="include">sg.atom.stage.select.SpatialSelectControl</span>;
<span class="keyword">import</span> <span class="include">magiccard.gameplay.CardGamePlay</span>;
<span class="keyword">import</span> <span class="include">magiccard.gameplay.Card</span>;
<span class="keyword">import</span> <span class="include">magiccard.gameplay.CardSpatialControl</span>;
<span class="keyword">import</span> <span class="include">sg.atom.stage.select.EntitySelectCondition</span>;

<span class="comment">/**
*
* @author cuong.nguyenmanh2
*/</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">CardSelectControl</span> <span class="directive">extends</span> SpatialSelectControl {

<span class="directive">private</span> Vector3f bigScale;
<span class="directive">private</span> Vector3f orginalScale;
<span class="directive">private</span> Vector3f orginalPos;
<span class="directive">private</span> Vector3f peakPos;
<span class="directive">private</span> <span class="type">boolean</span> skipOutHover;
<span class="directive">private</span> <span class="predefined-type">String</span> currentFunction;
<span class="directive">private</span> CardGamePlay gameplay;
<span class="directive">private</span> Card card;
<span class="directive">private</span> <span class="type">boolean</span> isBigger = <span class="predefined-constant">false</span>;
<span class="directive">private</span> <span class="type">boolean</span> isPeak = <span class="predefined-constant">false</span>;
<span class="directive">private</span> <span class="type">boolean</span> isHighlight = <span class="predefined-constant">false</span>;

<span class="directive">public</span> CardSelectControl(WorldManager worldManager, CardGamePlay gameplay) {
currentFunction = <span class="error">“</span>Normal<span class="error">”</span>;
<span class="local-variable">this</span>.gameplay = gameplay;
}

<span class="annotation">@Override</span>
<span class="directive">public</span> <span class="type">void</span> setSpatial(Spatial spatial) {
<span class="local-variable">super</span>.setSpatial(spatial);
<span class="local-variable">this</span>.card = (Card) spatial.getControl(CardSpatialControl.class).getEntity();
orginalScale = spatial.getLocalScale().clone();
bigScale = orginalScale.mult(<span class="float">1.2f</span>);
orginalPos = spatial.getLocalTranslation().clone();
}

<span class="annotation">@Override</span>
<span class="directive">protected</span> <span class="type">void</span> doSelected() {
<span class="local-variable">super</span>.doSelected();
<span class="comment">//orginalScale = spatial.getLocalScale();</span>
<span class="comment">//orginalPos = spatial.getLocalTranslation().clone();</span>
<span class="comment">//peakPos = orginalPos.add(new Vector3f(0f, 0.4f, 0f));</span>
<span class="comment">//spatial.setLocalTranslation(peakPos);</span>
<span class="comment">//spatial.setLocalScale(bigScale);</span>
}

<span class="annotation">@Override</span>
<span class="directive">protected</span> <span class="type">void</span> doDeselected() {
<span class="local-variable">super</span>.doDeselected();
<span class="comment">//spatial.setLocalScale(orginalScale);</span>
<span class="comment">//spatial.setLocalTranslation(orginalPos.clone());</span>

}

<span class="annotation">@Override</span>
<span class="directive">protected</span> <span class="type">void</span> doHovered() {
<span class="keyword">if</span> (<span class="local-variable">this</span>.isHoverable()) {
<span class="local-variable">super</span>.doHovered();
<span class="comment">//orginalScale = spatial.getLocalScale();</span>
EntitySelectCondition inHand = (EntitySelectCondition) gameplay.cardSelectRules.get(<span class="error">“</span>inHand<span class="error">”</span>);
EntitySelectCondition inGround = (EntitySelectCondition) gameplay.cardSelectRules.get(<span class="error">“</span>inGround<span class="error">”</span>);
<span class="keyword">if</span> (inHand.isSelected(card)) {
peak();
bigger();
highlight();
} <span class="keyword">else</span> <span class="keyword">if</span> (inGround.isSelected(card)) {
<span class="comment">// The card is the ground</span>
highlight();
}
}
}

<span class="annotation">@Override</span>
<span class="directive">protected</span> <span class="type">void</span> doOutHovered() {
<span class="keyword">if</span> (<span class="local-variable">this</span>.isHoverable()) {
<span class="keyword">if</span> (!<span class="local-variable">this</span>.skipOutHover) {
<span class="local-variable">super</span>.doOutHovered();

noPeak();
smaller();
noHighlight();

}
}
}

<span class="directive">public</span> <span class="predefined-type">String</span> getCurrentFunction() {
<span class="keyword">return</span> currentFunction;
}

<span class="directive">public</span> <span class="type">void</span> setCurrentFunction(<span class="predefined-type">String</span> currentFunction) {
<span class="local-variable">this</span>.currentFunction = currentFunction;
}

<span class="directive">public</span> <span class="type">void</span> setSkipOutHover(<span class="type">boolean</span> skipOutHover) {
<span class="local-variable">this</span>.skipOutHover = skipOutHover;
}

<span class="directive">public</span> <span class="type">boolean</span> isSkipOutHover() {
<span class="keyword">return</span> skipOutHover;
}

<span class="type">void</span> bigger() {
<span class="keyword">if</span> (!isBigger) {
spatial.setLocalScale(bigScale);
isBigger = <span class="predefined-constant">true</span>;
}
}

<span class="type">void</span> peak() {
<span class="keyword">if</span> (!isPeak) {
orginalPos = spatial.getLocalTranslation().clone();
peakPos = orginalPos.add(<span class="keyword">new</span> Vector3f(<span class="float">0f</span>, <span class="float">0.2f</span>, <span class="float">0.2f</span>));
spatial.setLocalTranslation(peakPos);
isPeak = <span class="predefined-constant">true</span>;
}
}

<span class="type">void</span> noPeak() {
<span class="keyword">if</span> (isPeak) {
spatial.setLocalTranslation(orginalPos.clone());
isPeak = <span class="predefined-constant">false</span>;
}
}

<span class="type">void</span> smaller() {
<span class="keyword">if</span> (isBigger) {
spatial.setLocalScale(orginalScale);
isBigger = <span class="predefined-constant">false</span>;
}
}

<span class="type">void</span> highlight() {
<span class="keyword">if</span> (!isHighlight) {
((Geometry) spatial).getMaterial().setBoolean(<span class="error">“</span>MixGlow<span class="error">”</span>, <span class="predefined-constant">true</span>);
isHighlight = <span class="predefined-constant">true</span>;
}
}

<span class="type">void</span> noHighlight() {
<span class="keyword">if</span> (isHighlight) {
((Geometry) spatial).getMaterial().setBoolean(<span class="error">“</span>MixGlow<span class="error">”</span>, <span class="predefined-constant">false</span>);
isHighlight = <span class="predefined-constant">false</span>;
}
}
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="cached-conditions-rules">Cached conditions – Rules:</h4>
<div class="paragraph">
<p>We use a Groovy Map cardSelectRules to save all rule in form of Closure that determine if a Card is selected or not. More about rules in the scripting part <a href="../../../jme3/atomixtuts/cardsgame/scripting.html">scripting</a></p>
</div>
<div class="paragraph">
<p>…part of CardGamePlay.groovy</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="predefined-type">Map</span> cardSelectRules=[:];
<span class="type">void</span> createSelectConditions(){
<span class="comment">// RULE : The card is in hand</span>
def inHandRule ={card-&gt;

CardPlayer player = whichPlayerCard(card)
<span class="keyword">if</span> (player.getHand().contains(card)) {
<span class="keyword">return</span> <span class="predefined-constant">true</span>;
}
<span class="keyword">return</span> <span class="predefined-constant">false</span>;
}
cardSelectRules[<span class="string"><span class="delimiter">&quot;</span><span class="content">inHand</span><span class="delimiter">&quot;</span></span>] =<span class="keyword">new</span> ClosureSelectCondition(inHandRule);

<span class="comment">// RULE : The card is in hand of the current player – who play this device!</span>
def inHandCurrentRule ={card-&gt;
<span class="keyword">if</span> (isCurrentPlayer(whichPlayerCard(card))) {
CardPlayer player = getCurrentPlayer();
<span class="keyword">if</span> (player.getHand().contains(card)) {
<span class="keyword">return</span> <span class="predefined-constant">true</span>;
}
}
<span class="keyword">return</span> <span class="predefined-constant">false</span>;
}
cardSelectRules[<span class="string"><span class="delimiter">&quot;</span><span class="content">inHandCurrent</span><span class="delimiter">&quot;</span></span>] =<span class="keyword">new</span> ClosureSelectCondition(inHandCurrentRule);

<span class="comment">// RULE : The card is in hand of the current turn player – who has this turn!</span>
def inHandTurnRule ={card-&gt;
<span class="keyword">if</span> (isCurrentPlayer(whichPlayerCard(card))) {
CardPlayer player = getCurrentPlayer();
<span class="keyword">if</span> (player.getHand().contains(card)) {
<span class="keyword">return</span> <span class="predefined-constant">true</span>;
}
}
<span class="keyword">return</span> <span class="predefined-constant">false</span>;
}
cardSelectRules[<span class="string"><span class="delimiter">&quot;</span><span class="content">inHandTurn</span><span class="delimiter">&quot;</span></span>] =<span class="keyword">new</span> ClosureSelectCondition(inHandTurnRule);
<span class="comment">// RULE: The card is in ground</span>
def inGroundRule ={card-&gt;

CardPlayer player = whichPlayerCard(card);
<span class="keyword">if</span> (player.ground.contains(card)) {
<span class="keyword">return</span> <span class="predefined-constant">true</span>;
}
<span class="keyword">return</span> <span class="predefined-constant">false</span>;
}
cardSelectRules[<span class="string"><span class="delimiter">&quot;</span><span class="content">inGround</span><span class="delimiter">&quot;</span></span>] =<span class="keyword">new</span> ClosureSelectCondition(inGroundRule);
<span class="comment">// RULE: Card in player Main phase</span>
def mainPhaseCards = {card-&gt;
<span class="keyword">if</span> (isCurrentPlayer(whichPlayerCard(card))) {
CardPlayer player = getCurrentPlayer();
<span class="keyword">if</span> (player.hand.contains(card)||player.ground.contains(card)||player.magic.contains(card)) {
<span class="comment">//println(“Condition true”);</span>
<span class="keyword">return</span> <span class="predefined-constant">true</span>;
}
}
<span class="keyword">return</span> <span class="predefined-constant">false</span>;
}
cardSelectRules[<span class="string"><span class="delimiter">&quot;</span><span class="content">mainPhaseCards</span><span class="delimiter">&quot;</span></span>] =<span class="keyword">new</span> ClosureSelectCondition(mainPhaseCards);
<span class="comment">// RULE: Can not select any thing</span>
def noneSelect = {card-&gt;
<span class="keyword">return</span> <span class="predefined-constant">false</span>;
}
cardSelectRules[<span class="string"><span class="delimiter">&quot;</span><span class="content">noneSelect</span><span class="delimiter">&quot;</span></span>] =<span class="keyword">new</span> ClosureSelectCondition(noneSelect);

}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="states">States</h3>
<div class="sect3">
<h4 id="mainmenustate">MainMenuState</h4>

</div>
<div class="sect3">
<h4 id="ingamestate">InGameState</h4>

</div>
<div class="sect3">
<h4 id="loadingstate">LoadingState</h4>

</div>
</div>
<div class="sect2">
<h3 id="managers">Managers</h3>

</div>
<div class="sect2">
<h3 id="controls">Controls</h3>

</div>
<div class="sect2">
<h3 id="cardlibrary">CardLibrary</h3>

</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Version <br>
Last updated 2016-06-06 21:21:23 UTC
</div>
</div>
</body>
</html>